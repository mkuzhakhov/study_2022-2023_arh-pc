**РОССИЙСКИЙ УНИВЕРСИТЕТ ДРУЖБЫ НАРОДОВ**

**Факультет физико-математических и естественных наук**

**Кафедра прикладной информатики и теории вероятностей**

**ОТЧЕТ**

**по лабораторной работе № [9]{.ul}**

*[дисциплина: Архитектура компьютера]{.ul}*

[Студент: Ужаков Магомед]{.ul}

Группа: НПИбд-02-22

**МОСКВА**

2022 г.

**Цель работы:**

Приобретение навыков написания программ с использованием циклов и
обработкой аргументов командной строки.

**Порядок выполнения лабораторной работы:**

**Реализация циклов в NASM.**

Создадим каталог для программ лабораторной работы №9, перейдем в него и
создадим нужный файл (рис. 1).

![](media/image1.png){width="4.96875in"
height="1.9791666666666667in"}

рис. 1. Создание файла lab9-1.asm

При реализации циклов в NASM с использованием инструкции loop необходимо
помнить о том, что эта инструкция использует регистр ecx в качестве
счетчика и на каждом шаге уменьшает его значение на единицу. В качестве
примера рассмотрим программу, которая выводит значение регистра ecx
(рис. 2).

![](media/image2.png){width="5.104166666666667in"
height="6.833333333333333in"}

рис. 2. Текст программы lab9-1

Создадим исполняемый файл и проверим его работу (рис. 3).

![](media/image3.png){width="3.7916666666666665in"
height="4.375in"}

рис. 3. Результат работы программы lab9-1

Данный пример показывает, что использование регистра ecx в теле цилка
loop может привести к некорректной работе программы. Изменим текст
программы добавив изменение значение регистра ecx в цикле по следующему
примеру

Создадим исполняемый файл и проверим его работу

![](media/image4.png){width="1.28125in"
height="0.7708333333333334in"}

рис. 5. Результат работы измененной программы lab9-1

Как видим, все работает. Регистр ecx принимает все значения от N до 1
включительно, что соответствует числу проходов цикла, введенному с
клавиатуры.

Для использования регистра ecx в цикле и сохранения корректности работы
программы можно использовать стек. Внесем изменения в текст программы по
примеру, добавив команды push и pop (добавления в стек и извлечения из
стека) для сохранения значения счетчика цикла loop

Создадим исполняемый файл и проверим его работу

Как видим, программа работает корректно, число проходов цикла
соответствует значению N, введенному с клавиатуры.

**Обработка аргументов командной строки.**

При разработке программ иногда встает необходимость указывать аргументы,
которые будут использоваться в программе, непосредственно из командной
строки при запуске программы. При запуске программы в NASM аргументы
командной строки загружаются в стек в обратном порядке, кроме того в
стек записывается имя программы и общее количество аргументов. Последние
два элемента стека для программы, скомпилированной NASM, -- это всегда
имя программы и количество переданных аргументов. Таким образом, для
того чтобы использовать аргументы в программе, их просто нужно извлечь
из стека. Обработку аргументов нужно проводить в цикле. Т.е. сначала
нужно извлечь из стека количество аргументов, а затем циклично для
каждого аргумента выполнить логику программы. В качестве примера
рассмотрим программу, которая выводит на экран аргументы командной
строки (рис. 8). Создадим в каталоге лабораторной работы №9 файл lab9-2

Затем создадим исполняемый файл и запустим программу, указав следующие
аргументы (рис. 9).

![](media/image5.png){width="6.208333333333333in"
height="2.40625in"}

рис. 9. Результат работы программы lab9-2

Как видим, программа восприняла "аргумент" и "2" как отдельные
аргументы, в то время как 'аргумент 3' как один. Соответственно
программой было обработано 4 аргумента.

Рассмотрим еще один пример программы которая выводит сумму чисел,
которые передаются в программу как аргументы. Создадим файл lab9-3.asm в
том же каталоге и введем в него следующий текст программы (рис. 10).

![](media/image6.png){width="4.239583333333333in"
height="6.96875in"}

рис. 10. Текст программы lab9-3

Затем создадим исполняемый файл и запустим его, указав аргументы (рис.
11).

![](media/image7.png){width="5.916666666666667in"
height="1.5104166666666667in"}

рис. 11. Результат работы программы lab9-3

Как видим, все работает корректно.

Изменим строку

*add esi,ecx*

на

*move ebx, eax*

*mov eax, esi*

*mul ecx*

*mov esi, eax*

а также присвоим esi значение 1, чтобы программа выводила произведение
аргументов командной строки и запустим ее

**Вывод:**

Во время выполнения лабораторной работы были приобретены навыки
написания программ с использованием циклов и обработкой аргументов
командной строки.
